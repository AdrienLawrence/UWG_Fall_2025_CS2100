<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editor - ScribeAI</title>
    <link rel="stylesheet" href="project.css">
    <style>
        /* Fix text area sizing */
        .editor-textarea {
            width: 100%;
            height: 70vh; /* Use viewport height instead of rows */
            border: none;
            resize: none;
            font-family: inherit;
            font-size: 1rem;
            line-height: 1.6;
            padding: 1rem;
            background: transparent;
            color: #000000;
            box-sizing: border-box; /* Include padding in width/height */
        }

        .editor-textarea:focus {
            outline: none;
        }

        .editor-textarea::placeholder {
            color: #9ca3af;
            font-style: italic;
        }

        /* Fix paper container */
        .paper {
            width: 100%;
            min-height: 80vh;
            background: white;
            padding: 2rem;
            color: #000000;
            box-sizing: border-box;
        }

        /* Character counter */
        .character-counter {
            text-align: center;
            padding: 0.5rem;
            background: #374151;
            border-radius: 4px;
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        /* Status message */
        .editor-status {
            margin-top: 1rem;
            padding-top: 0.5rem;
            border-top: 1px solid #e5e7eb;
            font-size: 0.8rem;
            color: #6b7280;
            text-align: center;
        }

        /* Make main content area fill space */
        .main-content {
            flex: 1;
            padding: 1rem;
            background: #000000;
            display: flex;
            justify-content: center;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="editor-container">

        <!-- Simple Sidebar -->
        <div class="sidebar">
            <!-- Character Counter -->
            <div class="sidebar-section">
                <div class="sidebar-label">Character Count</div>
                <div class="character-counter">
                    <span id="char-count">0</span>/2000
                </div>
            </div>

            <!-- File options -->
            <div class="sidebar-section">
                <div class="sidebar-label">File</div>
                <button type="button" class="sidebar-btn" id="save-btn">Save</button>
                <button type="button" class="sidebar-btn" onclick="location.href='notebooks.html'">Home</button>
            </div>
        </div>

        <!-- Navigation Arrows -->
        <div class="navigation">
            <button class="nav-arrow" aria-label="Previous page" onclick="navigatePage(-1)">
                ‹
            </button>
            <button class="nav-arrow" aria-label="Next page" onclick="navigatePage(1)">
                ›
            </button>
        </div>

        <!-- Main Content with Properly Sized Text Box -->
        <div class="main-content">
            <div class="paper">
                <input type="text" class="title-input" id="page-title" 
                       placeholder="Page Title" style="width: 100%; margin-bottom: 1rem;">
                
                <!-- Full Page Text Area -->
                <textarea class="editor-textarea" id="editor-content" 
                          placeholder="Start typing your notes here..."></textarea>
                
                <!-- Simple Status -->
                <div class="editor-status">
                    <span id="status-message">Ready to type</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Simple character counter and basic functionality
        function initializeEditor() {
            const textarea = document.getElementById('editor-content');
            const charCounter = document.getElementById('char-count');
            const statusMessage = document.getElementById('status-message');
            const saveButton = document.getElementById('save-btn');
            const titleInput = document.getElementById('page-title');
            
            console.log('Editor initialized'); // Debug log
            
            // Load any saved content
            loadSavedContent();
            
            // Character counter - FIXED
            textarea.addEventListener('input', function() {
                const charCount = this.value.length;
                console.log('Characters typed:', charCount); // Debug log
                charCounter.textContent = charCount;
                
                // Change color when approaching limit
                if (charCount > 1800) {
                    charCounter.style.color = '#f59e0b'; // Orange warning
                } else if (charCount >= 2000) {
                    charCounter.style.color = '#ef4444'; // Red error
                } else {
                    charCounter.style.color = '#ffffff'; // White
                }
                
                // Enforce character limit
                if (charCount > 2000) {
                    this.value = this.value.substring(0, 2000);
                    charCounter.textContent = '2000';
                    charCounter.style.color = '#ef4444';
                    statusMessage.textContent = 'Character limit reached!';
                    statusMessage.style.color = '#ef4444';
                    
                    // Clear status message after 3 seconds
                    setTimeout(() => {
                        statusMessage.textContent = 'Ready to type';
                        statusMessage.style.color = '#6b7280';
                    }, 3000);
                }
                
                updateStatus('Unsaved changes');
            });
            
            // Title input tracking
            titleInput.addEventListener('input', function() {
                updateStatus('Unsaved changes');
            });
            
            // Save button functionality
            saveButton.addEventListener('click', function() {
                saveContent();
                statusMessage.textContent = 'Saved successfully!';
                statusMessage.style.color = '#10b981'; // Green success
                
                // Clear success message after 2 seconds
                setTimeout(() => {
                    statusMessage.textContent = 'All changes saved';
                    statusMessage.style.color = '#6b7280';
                }, 2000);
            });
            
            // Auto-save every 30 seconds
            setInterval(() => {
                if (statusMessage.textContent === 'Unsaved changes') {
                    saveContent();
                    statusMessage.textContent = 'Auto-saved';
                    statusMessage.style.color = '#60a5fa'; // Blue info
                    
                    setTimeout(() => {
                        if (statusMessage.textContent === 'Auto-saved') {
                            statusMessage.textContent = 'All changes saved';
                            statusMessage.style.color = '#6b7280';
                        }
                    }, 2000);
                }
            }, 30000);
            
            // Initial character count update
            updateCharacterCount();
        }
        
        // Update character count on load
        function updateCharacterCount() {
            const textarea = document.getElementById('editor-content');
            const charCount = textarea.value.length;
            const charCounter = document.getElementById('char-count');
            charCounter.textContent = charCount;
            
            if (charCount > 1800) {
                charCounter.style.color = '#f59e0b';
            } else if (charCount >= 2000) {
                charCounter.style.color = '#ef4444';
            } else {
                charCounter.style.color = '#ffffff';
            }
        }
        
        // Update status message
        function updateStatus(message) {
            const statusMessage = document.getElementById('status-message');
            statusMessage.textContent = message;
            statusMessage.style.color = '#f59e0b'; // Yellow for unsaved
        }
        
        // Save content, doesn't actually save anywhere
        function saveContent() {
            const content = {
                title: document.getElementById('page-title').value,
                content: document.getElementById('editor-content').value,
                lastSaved: new Date().toLocaleString()
            };
            
            localStorage.setItem('scribeai-editor-content', JSON.stringify(content));
            console.log('Content saved'); // Debug log
        }
        
        // Simple navigation
        function navigatePage(direction) {
            const pageAction = direction > 0 ? 'next' : 'previous';
            alert(`Navigating to ${pageAction} page (demo feature)`);
        }
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', initializeEditor);
    </script>
</body>
</html>
